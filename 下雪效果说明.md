# ä¸‹é›ªæ•ˆæœè¯´æ˜ â„ï¸ğŸŒ¨ï¸

## åŠŸèƒ½æ¦‚è¿°

ä¸ºæ•´ä¸ªæ¸¸æˆåœºæ™¯æ·»åŠ äº†é€¼çœŸçš„ä¸‹é›ªæ•ˆæœï¼ŒåŒ…æ‹¬å¤šå±‚æ™¯æ·±ã€å…­è§’å½¢é›ªèŠ±ã€æ—‹è½¬åŠ¨ç”»å’Œè¿åŠ¨æ¨¡ç³Šã€‚

## é›ªèŠ±ç³»ç»Ÿ

### 1. é›ªèŠ±æ•°é‡ â„ï¸
- **ä¼˜åŒ–æ¨¡å¼**ï¼š300ä¸ªé›ªèŠ±
- **é«˜è´¨é‡æ¨¡å¼**ï¼š500ä¸ªé›ªèŠ±

### 2. é›ªèŠ±å±æ€§

æ¯ä¸ªé›ªèŠ±åŒ…å«ä»¥ä¸‹å±æ€§ï¼š

```javascript
{
    x: éšæœºä½ç½®,              // Xåæ ‡
    y: éšæœºä½ç½®,              // Yåæ ‡
    size: 0.5-4.5px,         // å¤§å°
    speed: 0.3-2.3px/frame,  // ä¸‹è½é€Ÿåº¦
    drift: -0.4~0.4,         // å·¦å³æ¼‚ç§»
    opacity: 0.3-1.0,        // é€æ˜åº¦
    rotation: 0-2Ï€,          // æ—‹è½¬è§’åº¦
    rotationSpeed: Â±0.01,    // æ—‹è½¬é€Ÿåº¦
    layer: 'near'|'mid'|'far', // æ™¯æ·±å±‚æ¬¡
    wobble: 0-2Ï€,            // æ‘†åŠ¨ç›¸ä½
    wobbleSpeed: 0.01-0.04   // æ‘†åŠ¨é€Ÿåº¦
}
```

## è§†è§‰æ•ˆæœ

### 1. æ™¯æ·±å±‚æ¬¡ ğŸ¨

#### è¿œæ™¯å±‚ (far)
- **é€æ˜åº¦**ï¼š40%
- **å¤§å°**ï¼š60%
- **æ•ˆæœ**ï¼šæ¨¡ç³Šã€æœ¦èƒ§

#### ä¸­æ™¯å±‚ (mid)
- **é€æ˜åº¦**ï¼š70%
- **å¤§å°**ï¼š80%
- **æ•ˆæœ**ï¼šåŠé€æ˜

#### è¿‘æ™¯å±‚ (near)
- **é€æ˜åº¦**ï¼š100%
- **å¤§å°**ï¼š100%
- **æ•ˆæœ**ï¼šæ¸…æ™°ã€æ˜äº®

### 2. é›ªèŠ±å½¢çŠ¶ â„ï¸

#### å¤§é›ªèŠ± (size > 2.5px)
```
    *
   /|\
  * | *
 ---+---
  * | *
   \|/
    *
```
- **å…­è§’å½¢ç»“æ„**
- **6æ¡ä¸»å°„çº¿**
- **12æ¡å°åˆ†æ”¯**
- **ä¸­å¿ƒäº®ç‚¹**
- **æ—‹è½¬åŠ¨ç”»**

#### å°é›ªèŠ± (size â‰¤ 2.5px)
```
  â—‹
```
- **ç®€å•åœ†å½¢**
- **å¸¦é«˜å…‰**
- **å¿«é€Ÿé£˜è½**

### 3. åŠ¨ç”»æ•ˆæœ ğŸ¬

#### ä¸‹è½åŠ¨ç”»
```javascript
snow.y += snow.speed; // 0.3-2.3px/frame
```

#### æ‘†åŠ¨åŠ¨ç”»
```javascript
snow.wobble += snow.wobbleSpeed;
const wobbleOffset = Math.sin(snow.wobble) * 1.5;
snow.x += snow.drift + wobbleOffset;
```

#### æ—‹è½¬åŠ¨ç”»
```javascript
snow.rotation += snow.rotationSpeed; // Â±0.01 rad/frame
```

### 4. è¿‘æ™¯è¿åŠ¨æ¨¡ç³Š ğŸ’¨

é¢å¤–çš„30ä¸ªå¿«é€Ÿé£˜è¿‡çš„å¤§é›ªèŠ±ï¼š
- **é€Ÿåº¦**ï¼š5å€è·ç¦»é€Ÿåº¦
- **å¤§å°**ï¼š3-6px
- **é€æ˜åº¦**ï¼šåŠ¨æ€é—ªçƒ
- **è¿åŠ¨æ¨¡ç³Š**ï¼šæ¤­åœ†å½¢æ‹–å°¾

## æŠ€æœ¯å®ç°

### åˆå§‹åŒ–
```javascript
initFallingSnow() {
    const snowCount = CONFIG.enableOptimization ? 300 : 500;
    for (let i = 0; i < snowCount; i++) {
        this.fallingSnow.push({
            // ... é›ªèŠ±å±æ€§
        });
    }
}
```

### æ›´æ–°é€»è¾‘
```javascript
// åŸºç¡€ä¸‹è½
snow.y += snow.speed;

// æ‘†åŠ¨æ•ˆæœ
snow.wobble += snow.wobbleSpeed;
const wobbleOffset = Math.sin(snow.wobble) * 1.5;
snow.x += snow.drift + wobbleOffset;

// æ—‹è½¬æ•ˆæœ
snow.rotation += snow.rotationSpeed;

// å¾ªç¯é‡ç½®
if (snow.y > this.canvas.height + 10) {
    snow.y = -10;
    snow.x = Math.random() * this.canvas.width;
}
```

### ç»˜åˆ¶é€»è¾‘
```javascript
// æŒ‰æ™¯æ·±å±‚æ¬¡ç»˜åˆ¶
['far', 'mid', 'near'].forEach(layer => {
    this.fallingSnow.forEach(snow => {
        if (snow.layer !== layer) return;
        
        // è°ƒæ•´é€æ˜åº¦å’Œå¤§å°
        // ç»˜åˆ¶å…­è§’å½¢æˆ–åœ†å½¢
        // åº”ç”¨æ—‹è½¬å˜æ¢
    });
});
```

## æ€§èƒ½ä¼˜åŒ–

### 1. æ‰¹é‡æ›´æ–°
```javascript
const snowLen = this.fallingSnow.length;
for (let i = 0; i < snowLen; i++) {
    // ç›´æ¥è®¿é—®æ•°ç»„å…ƒç´ ï¼Œé¿å…forEachå¼€é”€
}
```

### 2. åˆ†å±‚æ¸²æŸ“
- å…ˆç»˜åˆ¶è¿œæ™¯ï¼ˆå°‘é‡ï¼‰
- å†ç»˜åˆ¶ä¸­æ™¯ï¼ˆä¸­ç­‰ï¼‰
- æœ€åç»˜åˆ¶è¿‘æ™¯ï¼ˆå¤§é‡ï¼‰

### 3. æ¡ä»¶æ¸²æŸ“
- åªç»˜åˆ¶å½“å‰å±‚æ¬¡çš„é›ªèŠ±
- è·³è¿‡ä¸å¯è§çš„é›ªèŠ±

### 4. ä¼˜åŒ–æ¨¡å¼
```javascript
CONFIG.enableOptimization ? 300 : 500
```

## è§†è§‰å±‚æ¬¡

### èƒŒæ™¯åˆ°å‰æ™¯
1. **å¤©ç©ºæ¸å˜** - æ·±è“åˆ°æµ…è“
2. **æ˜Ÿæ˜Ÿ** - é—ªçƒçš„å°ç‚¹
3. **æœˆäº®** - å³ä¸Šè§’
4. **äº‘æœµ** - åŠé€æ˜
5. **è¿œæ™¯é›ªèŠ±** - 40%é€æ˜åº¦
6. **ä¸­æ™¯é›ªèŠ±** - 70%é€æ˜åº¦
7. **è¿‘æ™¯é›ªèŠ±** - 100%é€æ˜åº¦
8. **åœ°å½¢** - ç™½è‰²é›ªåœ°
9. **è¿åŠ¨æ¨¡ç³Šé›ªèŠ±** - å¿«é€Ÿé£˜è¿‡

## å‚æ•°è°ƒæ•´

### å¯è°ƒå‚æ•°
```javascript
// é›ªèŠ±æ•°é‡
const SNOW_COUNT = 300-500;

// å¤§å°èŒƒå›´
const SIZE_MIN = 0.5;
const SIZE_MAX = 4.5;

// é€Ÿåº¦èŒƒå›´
const SPEED_MIN = 0.3;
const SPEED_MAX = 2.3;

// æ‘†åŠ¨å¹…åº¦
const WOBBLE_AMPLITUDE = 1.5;

// æ—‹è½¬é€Ÿåº¦
const ROTATION_SPEED = 0.01;

// æ™¯æ·±åˆ†å¸ƒ
const NEAR_RATIO = 0.3;  // 30%è¿‘æ™¯
const MID_RATIO = 0.35;  // 35%ä¸­æ™¯
const FAR_RATIO = 0.35;  // 35%è¿œæ™¯
```

### è°ƒæ•´å»ºè®®
- **æ›´å¯†é›†**ï¼šå¢åŠ `SNOW_COUNT`
- **æ›´ç¨€ç–**ï¼šå‡å°‘`SNOW_COUNT`
- **æ›´å¿«**ï¼šå¢åŠ `SPEED_MAX`
- **æ›´æ…¢**ï¼šå‡å°‘`SPEED_MIN`
- **æ›´é£˜é€¸**ï¼šå¢åŠ `WOBBLE_AMPLITUDE`
- **æ›´ç¨³å®š**ï¼šå‡å°‘`WOBBLE_AMPLITUDE`

## ç‰¹æ®Šæ•ˆæœ

### 1. å…­è§’å½¢é›ªèŠ±
- 6æ¡ä¸»å°„çº¿ï¼ˆ60åº¦é—´éš”ï¼‰
- æ¯æ¡å°„çº¿æœ‰2ä¸ªå°åˆ†æ”¯
- ä¸­å¿ƒæœ‰äº®ç‚¹
- æ•´ä½“æ—‹è½¬

### 2. è¿åŠ¨æ¨¡ç³Š
- æ¤­åœ†å½¢æ‹–å°¾
- åŠ¨æ€é€æ˜åº¦
- å¿«é€Ÿç§»åŠ¨æ„Ÿ

### 3. æ™¯æ·±æ¨¡ç³Š
- è¿œæ™¯é›ªèŠ±æ›´å°æ›´æ¨¡ç³Š
- è¿‘æ™¯é›ªèŠ±æ›´å¤§æ›´æ¸…æ™°
- è‡ªç„¶çš„æ·±åº¦æ„Ÿ

## æ¸¸æˆä½“éªŒ

### æ°›å›´è¥é€ 
- âœ… å†¬å­£é›ªæ™¯æ°›å›´
- âœ… åŠ¨æ€å¤©æ°”æ•ˆæœ
- âœ… æ²‰æµ¸å¼ä½“éªŒ
- âœ… è§†è§‰å±‚æ¬¡ä¸°å¯Œ

### è§†è§‰åé¦ˆ
- âœ… é€Ÿåº¦æ„Ÿï¼ˆé›ªèŠ±å¿«é€Ÿé£˜è¿‡ï¼‰
- âœ… æ·±åº¦æ„Ÿï¼ˆå¤šå±‚æ™¯æ·±ï¼‰
- âœ… çœŸå®æ„Ÿï¼ˆå…­è§’å½¢é›ªèŠ±ï¼‰
- âœ… åŠ¨æ€æ„Ÿï¼ˆæ—‹è½¬æ‘†åŠ¨ï¼‰

## æœªæ¥æ‰©å±•

å¯èƒ½çš„å¢å¼ºåŠŸèƒ½ï¼š
- [ ] æš´é£é›ªæ¨¡å¼ï¼ˆæ›´å¤šæ›´å¿«çš„é›ªèŠ±ï¼‰
- [ ] é›ªèŠ±å †ç§¯æ•ˆæœ
- [ ] é£å‘å˜åŒ–ï¼ˆé›ªèŠ±æ–œé£˜ï¼‰
- [ ] é›ªèŠ±èåŒ–æ•ˆæœ
- [ ] ä¸åŒå½¢çŠ¶çš„é›ªèŠ±
- [ ] é›ªèŠ±ç¢°æ’æ•ˆæœ
- [ ] å¤©æ°”ç³»ç»Ÿï¼ˆæ™´å¤©/é›ªå¤©åˆ‡æ¢ï¼‰
- [ ] é›ªèŠ±éŸ³æ•ˆ
