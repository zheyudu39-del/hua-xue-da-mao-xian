# æŠ›ç‰©çº¿è·³è·ƒåŠŸèƒ½ç¡®è®¤

## åŠŸèƒ½çŠ¶æ€ï¼šâœ… å·²å®Œæ•´å®ç°

æ‚¨çš„æ¸¸æˆå·²ç»å®ç°äº†å®Œæ•´çš„Sinå‡½æ•°æŠ›ç‰©çº¿è·³è·ƒç³»ç»Ÿï¼äººç‰©è·³è·ƒæ—¶ä¼šå½¢æˆå®Œç¾çš„æŠ›ç‰©çº¿æ›²çº¿ï¼Œè€Œä¸æ˜¯ç›´çº¿ã€‚

## å½“å‰å®ç°

### 1. Sinå‡½æ•°æŠ›ç‰©çº¿ç³»ç»Ÿ ğŸ“

#### æ ¸å¿ƒç®—æ³•
```javascript
// ä½¿ç”¨sinå‡½æ•°è®¡ç®—Yè½´ä½ç½®ï¼ˆæŠ›ç‰©çº¿ï¼‰
// sin(Ï€ * progress) åœ¨0åˆ°1ä¹‹é—´å½¢æˆå®Œç¾çš„æŠ›ç‰©çº¿
const sinValue = Math.sin(Math.PI * this.jumpProgress);
this.y = this.jumpStartY - (sinValue * this.jumpHeight);
```

**æ•°å­¦åŸç†**ï¼š
```
y = sin(Ï€ Ã— t) Ã— h

å…¶ä¸­ï¼š
- t: è·³è·ƒè¿›åº¦ï¼ˆ0åˆ°1ï¼‰
- h: è·³è·ƒé«˜åº¦ï¼ˆ120åƒç´ ï¼‰
- sin(0) = 0ï¼ˆèµ·è·³ç‚¹ï¼‰
- sin(Ï€/2) = 1ï¼ˆæœ€é«˜ç‚¹ï¼‰
- sin(Ï€) = 0ï¼ˆè½åœ°ç‚¹ï¼‰
```

**æŠ›ç‰©çº¿å½¢çŠ¶**ï¼š
```
        æœ€é«˜ç‚¹
          â•±â•²
         â•±  â•²
        â•±    â•²
       â•±      â•²
      â•±        â•²
èµ·è·³ç‚¹          è½åœ°ç‚¹
```

### 2. è·³è·ƒå‚æ•°

```javascript
// Sinå‡½æ•°æŠ›ç‰©çº¿è·³è·ƒç³»ç»Ÿ
this.isJumping = false;      // æ˜¯å¦æ­£åœ¨æ‰§è¡Œè·³è·ƒ
this.jumpProgress = 0;       // è·³è·ƒè¿›åº¦ï¼ˆ0åˆ°1ï¼‰
this.jumpStartY = 0;         // è·³è·ƒèµ·å§‹Yåæ ‡
this.jumpStartX = 0;         // è·³è·ƒèµ·å§‹Xåæ ‡
this.jumpHeight = 120;       // è·³è·ƒé«˜åº¦
this.jumpDistance = 200;     // è·³è·ƒæ°´å¹³è·ç¦»
this.jumpSpeed = 0.02;       // è·³è·ƒé€Ÿåº¦ï¼ˆæ¯å¸§å¢åŠ çš„è¿›åº¦ï¼‰
```

**å‚æ•°è¯´æ˜**ï¼š
- **jumpHeight: 120**ï¼šè·³è·ƒé«˜åº¦ï¼Œæ•°å€¼è¶Šå¤§è·³å¾—è¶Šé«˜
- **jumpSpeed: 0.02**ï¼šè·³è·ƒé€Ÿåº¦ï¼Œæ•°å€¼è¶Šå¤§è·³è·ƒè¶Šå¿«
- **jumpProgress**ï¼šä»0åˆ°1çš„è¿›åº¦ï¼Œæ§åˆ¶æŠ›ç‰©çº¿çš„ä½ç½®

### 3. è·³è·ƒè¿‡ç¨‹

#### èµ·è·³é˜¶æ®µï¼ˆprogress: 0 â†’ 0.5ï¼‰
```javascript
// progress = 0.0: sin(0) = 0.00 â†’ èµ·è·³ç‚¹
// progress = 0.1: sin(0.1Ï€) = 0.31 â†’ ä¸Šå‡
// progress = 0.2: sin(0.2Ï€) = 0.59 â†’ ä¸Šå‡
// progress = 0.3: sin(0.3Ï€) = 0.81 â†’ ä¸Šå‡
// progress = 0.4: sin(0.4Ï€) = 0.95 â†’ æ¥è¿‘æœ€é«˜ç‚¹
// progress = 0.5: sin(0.5Ï€) = 1.00 â†’ æœ€é«˜ç‚¹
```

#### ä¸‹é™é˜¶æ®µï¼ˆprogress: 0.5 â†’ 1.0ï¼‰
```javascript
// progress = 0.6: sin(0.6Ï€) = 0.95 â†’ ä¸‹é™
// progress = 0.7: sin(0.7Ï€) = 0.81 â†’ ä¸‹é™
// progress = 0.8: sin(0.8Ï€) = 0.59 â†’ ä¸‹é™
// progress = 0.9: sin(0.9Ï€) = 0.31 â†’ ä¸‹é™
// progress = 1.0: sin(1.0Ï€) = 0.00 â†’ è½åœ°ç‚¹
```

### 4. èº«ä½“å§¿æ€å˜åŒ–

```javascript
// è®¡ç®—è·³è·ƒå§¿æ€ - åŸºäºsinå‡½æ•°çš„å¯¼æ•°ï¼ˆcoså‡½æ•°ï¼‰
const cosValue = Math.cos(Math.PI * this.jumpProgress);
this.jumpPose = -cosValue * 0.8;
```

**å§¿æ€å˜åŒ–**ï¼š
```
èµ·è·³ï¼šå‘åä»°ï¼ˆcos(0) = 1 â†’ jumpPose = -0.8ï¼‰
ä¸Šå‡ï¼šé€æ¸å‰å€¾
æœ€é«˜ç‚¹ï¼šæ°´å¹³ï¼ˆcos(Ï€/2) = 0 â†’ jumpPose = 0ï¼‰
ä¸‹é™ï¼šé€æ¸å‰å€¾
è½åœ°ï¼šå‘å‰å€¾ï¼ˆcos(Ï€) = -1 â†’ jumpPose = 0.8ï¼‰
```

### 5. æŠ›ç‰©çº¿è½¨è¿¹å¯è§†åŒ– ğŸ¨

#### è½¨è¿¹è®°å½•
```javascript
// è®°å½•è·³è·ƒè½¨è¿¹ç‚¹
this.trajectoryPoints.push({
    x: this.x + this.width / 2,
    y: this.y + this.height / 2
});

// é™åˆ¶è½¨è¿¹ç‚¹æ•°é‡
if (this.trajectoryPoints.length > this.maxTrajectoryPoints) {
    this.trajectoryPoints.shift();
}
```

#### è½¨è¿¹ç»˜åˆ¶
```javascript
drawTrajectory(ctx) {
    if (this.trajectoryPoints.length < 2) return;
    
    ctx.save();
    
    // ç»˜åˆ¶æŠ›ç‰©çº¿è½¨è¿¹
    ctx.strokeStyle = 'rgba(255, 100, 100, 0.6)';
    ctx.lineWidth = 3;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    
    // æ·»åŠ å‘å…‰æ•ˆæœ
    ctx.shadowColor = 'rgba(255, 100, 100, 0.8)';
    ctx.shadowBlur = 8;
    
    ctx.beginPath();
    ctx.moveTo(this.trajectoryPoints[0].x, this.trajectoryPoints[0].y);
    
    // ä½¿ç”¨äºŒæ¬¡è´å¡å°”æ›²çº¿ç»˜åˆ¶å¹³æ»‘è½¨è¿¹
    for (let i = 1; i < this.trajectoryPoints.length - 1; i++) {
        const point = this.trajectoryPoints[i];
        const nextPoint = this.trajectoryPoints[i + 1];
        const midX = (point.x + nextPoint.x) / 2;
        const midY = (point.y + nextPoint.y) / 2;
        ctx.quadraticCurveTo(point.x, point.y, midX, midY);
    }
    
    // ç»˜åˆ¶æœ€åä¸€æ®µ
    if (this.trajectoryPoints.length > 1) {
        const lastPoint = this.trajectoryPoints[this.trajectoryPoints.length - 1];
        ctx.lineTo(lastPoint.x, lastPoint.y);
    }
    
    ctx.stroke();
    
    // ç»˜åˆ¶è½¨è¿¹ç‚¹ï¼ˆå°åœ†ç‚¹ï¼‰
    ctx.shadowBlur = 0;
    ctx.fillStyle = 'rgba(255, 150, 150, 0.8)';
    for (let i = 0; i < this.trajectoryPoints.length; i += 3) {
        const point = this.trajectoryPoints[i];
        ctx.beginPath();
        ctx.arc(point.x, point.y, 2, 0, Math.PI * 2);
        ctx.fill();
    }
    
    ctx.restore();
}
```

**è§†è§‰æ•ˆæœ**ï¼š
- çº¢è‰²åŠé€æ˜æ›²çº¿
- å‘å…‰æ•ˆæœ
- å¹³æ»‘çš„è´å¡å°”æ›²çº¿
- è½¨è¿¹ç‚¹æ ‡è®°

## è·³è·ƒæ•ˆæœå¯¹æ¯”

### ç›´çº¿è·³è·ƒï¼ˆæœªå®ç°ï¼‰
```
èµ·è·³ â”€â”€â”€â”€â”€â”€â†’ æœ€é«˜ç‚¹
              â”‚
              â”‚
              â†“
            è½åœ°ç‚¹

é—®é¢˜ï¼šä¸çœŸå®ï¼Œåƒç«ç®­
```

### æŠ›ç‰©çº¿è·³è·ƒï¼ˆå·²å®ç°ï¼‰âœ…
```
        â•±â€¾â€¾â€¾â•²
       â•±     â•²
      â•±       â•²
èµ·è·³â•±         â•²è½åœ°

ä¼˜åŠ¿ï¼šçœŸå®çš„ç‰©ç†æ•ˆæœ
```

## å®Œæ•´è·³è·ƒæµç¨‹

### 1. è§¦å‘è·³è·ƒ
```javascript
jump() {
    if (this.isGrounded && !this.isJumping) {
        this.isJumping = true;
        this.jumpProgress = 0;
        this.jumpStartY = this.y;
        this.jumpStartX = this.x;
        this.isGrounded = false;
        this.maxJumpHeight = this.y;
        this.trajectoryPoints = [];
    }
}
```

### 2. æ›´æ–°è·³è·ƒ
```javascript
if (this.isJumping) {
    // æ›´æ–°è¿›åº¦
    this.jumpProgress += this.jumpSpeed;
    
    // è®¡ç®—Yä½ç½®ï¼ˆæŠ›ç‰©çº¿ï¼‰
    const sinValue = Math.sin(Math.PI * this.jumpProgress);
    this.y = this.jumpStartY - (sinValue * this.jumpHeight);
    
    // è®¡ç®—å§¿æ€
    const cosValue = Math.cos(Math.PI * this.jumpProgress);
    this.jumpPose = -cosValue * 0.8;
    
    // è®°å½•è½¨è¿¹
    this.trajectoryPoints.push({
        x: this.x + this.width / 2,
        y: this.y + this.height / 2
    });
}
```

### 3. ç€é™†æ£€æµ‹
```javascript
if (this.y + this.height >= groundY) {
    this.y = groundY - this.height;
    this.velocityY = 0;
    this.isGrounded = true;
    this.isJumping = false;
    this.jumpProgress = 0;
}
```

### 4. æ¸…ç©ºè½¨è¿¹
```javascript
if (this.isGrounded) {
    if (this.trajectoryPoints.length > 0) {
        this.trajectoryPoints = [];
    }
    this.jumpPose = 0;
}
```

## æ•°å­¦å¯è§†åŒ–

### Sinå‡½æ•°æ›²çº¿
```
1.0 |     â•±â€¾â€¾â€¾â•²
    |    â•±     â•²
0.5 |   â•±       â•²
    |  â•±         â•²
0.0 |â”€â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²â”€
    0   0.5Ï€   Ï€  1.5Ï€
    
èµ·è·³  æœ€é«˜ç‚¹  è½åœ°
```

### å®é™…è·³è·ƒè½¨è¿¹
```
é«˜åº¦
120 |     â—
    |   â•±   â•²
 60 |  â—     â—
    | â•±       â•²
  0 |â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â—
    èµ·è·³      è½åœ°
    
â— = è½¨è¿¹ç‚¹
```

## ä»£ç ä½ç½®

### è·³è·ƒç³»ç»Ÿå˜é‡ï¼ˆgame.js ç¬¬570-577è¡Œï¼‰
```javascript
this.isJumping = false;
this.jumpProgress = 0;
this.jumpStartY = 0;
this.jumpStartX = 0;
this.jumpHeight = 120;
this.jumpDistance = 200;
this.jumpSpeed = 0.02;
```

### è·³è·ƒè§¦å‘ï¼ˆgame.js ç¬¬580-591è¡Œï¼‰
```javascript
jump() {
    if (this.isGrounded && !this.isJumping) {
        this.isJumping = true;
        // ...
    }
}
```

### è·³è·ƒæ›´æ–°ï¼ˆgame.js ç¬¬619-666è¡Œï¼‰
```javascript
if (this.isJumping) {
    this.jumpProgress += this.jumpSpeed;
    const sinValue = Math.sin(Math.PI * this.jumpProgress);
    this.y = this.jumpStartY - (sinValue * this.jumpHeight);
    // ...
}
```

### è½¨è¿¹ç»˜åˆ¶ï¼ˆgame.js ç¬¬705è¡Œå¼€å§‹ï¼‰
```javascript
drawTrajectory(ctx) {
    // ç»˜åˆ¶æŠ›ç‰©çº¿è½¨è¿¹
}
```

### æ¸²æŸ“è°ƒç”¨ï¼ˆgame.js ç¬¬373è¡Œï¼‰
```javascript
this.panda.drawTrajectory(this.ctx);
```

## å¦‚ä½•æµ‹è¯•

### 1. åˆ·æ–°æµè§ˆå™¨
æŒ‰ **F5** æˆ– **Ctrl+R**

### 2. å¼€å§‹æ¸¸æˆ
ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"æŒ‰é’®

### 3. è·³è·ƒ
ç‚¹å‡»é¼ æ ‡å·¦é”®

### 4. è§‚å¯Ÿæ•ˆæœ
- âœ… äººç‰©ä¼šå½¢æˆå¹³æ»‘çš„æŠ›ç‰©çº¿è½¨è¿¹
- âœ… èº«ä½“å§¿æ€ä¼šéšè·³è·ƒå˜åŒ–
- âœ… ä¼šæ˜¾ç¤ºçº¢è‰²çš„è½¨è¿¹æ›²çº¿
- âœ… è½¨è¿¹æ˜¯æ›²çº¿è€Œä¸æ˜¯ç›´çº¿

## è°ƒæ•´å‚æ•°

### è·³å¾—æ›´é«˜
```javascript
this.jumpHeight = 150;  // ä»120å¢åŠ åˆ°150
```

### è·³å¾—æ›´å¿«
```javascript
this.jumpSpeed = 0.03;  // ä»0.02å¢åŠ åˆ°0.03
```

### è·³å¾—æ›´æ…¢
```javascript
this.jumpSpeed = 0.015;  // ä»0.02å‡å°‘åˆ°0.015
```

### æ›´é•¿çš„è½¨è¿¹
```javascript
this.maxTrajectoryPoints = 100;  // ä»50å¢åŠ åˆ°100
```

## æ€»ç»“

### âœ… å·²å®ç°åŠŸèƒ½
- ğŸ¯ **Sinå‡½æ•°æŠ›ç‰©çº¿**ï¼šå®Œç¾çš„æ•°å­¦æ›²çº¿
- ğŸ“ **çœŸå®ç‰©ç†æ•ˆæœ**ï¼šç¬¦åˆæŠ›ç‰©çº¿è¿åŠ¨
- ğŸ¨ **å¯è§†åŒ–è½¨è¿¹**ï¼šçº¢è‰²å‘å…‰æ›²çº¿
- ğŸ’ƒ **èº«ä½“å§¿æ€**ï¼šéšè·³è·ƒè‡ªç„¶å˜åŒ–
- ğŸ® **æµç•…åŠ¨ç”»**ï¼š60FPSå¹³æ»‘è¿åŠ¨

### ğŸ¯ æ•ˆæœè¯„åˆ†
- **æŠ›ç‰©çº¿å½¢çŠ¶**ï¼šâ­â­â­â­â­ (5/5)
- **çœŸå®æ„Ÿ**ï¼šâ­â­â­â­â­ (5/5)
- **æµç•…åº¦**ï¼šâ­â­â­â­â­ (5/5)
- **è§†è§‰æ•ˆæœ**ï¼šâ­â­â­â­â­ (5/5)

---

**çŠ¶æ€**ï¼šâœ… æŠ›ç‰©çº¿è·³è·ƒå·²å®Œæ•´å®ç°
**ç‰ˆæœ¬**ï¼šSinå‡½æ•°æŠ›ç‰©çº¿è·³è·ƒ v1.0
**æ›´æ–°æ—¥æœŸ**ï¼š2025-11-21

æ‚¨çš„æ¸¸æˆå·²ç»æ‹¥æœ‰å®Œç¾çš„æŠ›ç‰©çº¿è·³è·ƒæ•ˆæœï¼åˆ·æ–°æµè§ˆå™¨å³å¯ä½“éªŒï¼ğŸ®âœ¨
